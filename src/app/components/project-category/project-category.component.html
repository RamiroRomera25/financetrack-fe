<app-project-sidebar></app-project-sidebar>
<div class="categories-container">
  <h1 class="section-title">Categorías</h1>
  <p class="section-subtitle">Gestiona las categorías para clasificar tus transacciones</p>

  <div class="categories-layout">
    <!-- Categories List Section -->
    <mat-card class="categories-list-card">
      <mat-card-header>
        <mat-card-title>Lista de Categorías</mat-card-title>
        <span class="category-count">{{ categories.length }} categorías</span>
      </mat-card-header>

      <mat-card-content>
        <div class="search-container">
          <mat-form-field appearance="outline" class="search-field">
            <mat-label>Buscar categoría</mat-label>
            <input matInput placeholder="Nombre de la categoría">
            <mat-icon matSuffix>search</mat-icon>
          </mat-form-field>
        </div>

        <div class="categories-list">
          <div class="category-item" *ngFor="let category of categories">
            <div class="category-color" [style.background-color]="category.color"></div>
            <div class="category-details">
              <div class="category-name">{{ category.name }}</div>
              <div class="category-transactions">{{ category.transactionCount }} transacciones</div>
            </div>
            <div class="category-actions">
              <button mat-icon-button color="primary" (click)="editCategory(category)" matTooltip="Editar categoría">
                <mat-icon>edit</mat-icon>
              </button>
              <button mat-icon-button color="warn" (click)="deleteCategory(category.id)" matTooltip="Eliminar categoría">
                <mat-icon>delete</mat-icon>
              </button>
            </div>
          </div>

          <div *ngIf="categories.length === 0" class="empty-state">
            <mat-icon>category</mat-icon>
            <p>No hay categorías disponibles</p>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Category Form Section -->
    <mat-card class="category-form-card">
      <mat-card-header>
        <mat-card-title>Nueva Categoría</mat-card-title>
      </mat-card-header>

      <mat-card-content>
        <form [formGroup]="categoryForm" (ngSubmit)="onSubmit()" class="category-form">
          <mat-form-field appearance="outline">
            <mat-label>Nombre de la categoría</mat-label>
            <input matInput formControlName="name" placeholder="Ej: Alimentación">
            <mat-error *ngIf="categoryForm.get('name')?.hasError('required')">
              El nombre es obligatorio
            </mat-error>
            <mat-error *ngIf="categoryForm.get('name')?.hasError('minlength')">
              El nombre debe tener al menos 2 caracteres
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Color</mat-label>
            <mat-select formControlName="color">
              <mat-select-trigger>
                <div class="color-preview-container">
                  <div class="color-preview" [style.background-color]="categoryForm.get('color')?.value"></div>
                </div>
              </mat-select-trigger>
              <mat-option *ngFor="let color of predefinedColors" [value]="color.value">
                <div class="color-option">
                  <div class="color-swatch" [style.background-color]="color.value"></div>
                  <span>{{ color.name }}</span>
                </div>
              </mat-option>
            </mat-select>
          </mat-form-field>

          <div class="color-preview-large" [style.background-color]="categoryForm.get('color')?.value">
            <div class="color-preview-text">Vista previa</div>
          </div>

          <div class="form-actions">
            <button mat-button type="reset">Cancelar</button>
            <button
              mat-raised-button
              color="primary"
              type="submit"
              [disabled]="categoryForm.invalid">
              Crear Categoría
            </button>
          </div>
        </form>
      </mat-card-content>
    </mat-card>
  </div>
</div>
